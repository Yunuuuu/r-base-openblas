#-*- Makefile -*-

## Toolchain config
WIN = 64

## Produce a debug build
# DEBUG = 1

## Add custom compile flags here
# EOPTS = -mtune=generic -pipe # To use the same installer on different computers
EOPTS = -march=native -pipe
# According to Martin Maechler (offlist of r-devel), 
# this appears to be a compiler bug in GCC (10.3 version).
# So fused-multiply-add needs to be turned off.
# LTO = -flto -ffat-lto-objects -fuse-linker-plugin
# LTO_OPT = -flto -ffat-lto-objects -fuse-linker-plugin
# LTO_FC_OPT = -flto -ffat-lto-objects -fuse-linker-plugin

# Enable features
USE_ICU = YES
USE_LIBCURL = YES
BUILD_HTML = YES
USE_ATLAS = YES
MIKTEX = TRUE
OPENMP = -fopenmp
ATLAS_PATH=/ucrt64/lib/

## Curl / ICU flags
CURL_LIBS = -lcurl -lssh2 -lz -lssl -lcrypto -lgdi32 -lws2_32 -lcrypt32 -lwldap32
ICU_LIBS = -licuin -licuuc -licudt -lstdc++

# Cairo flags
USE_CAIRO = YES
CAIRO_LIBS = "-lcairo -lfreetype -lpng -lpixman-1 -lz -liconv -lgdi32 -lmsimg32"
CAIRO_CPPFLAGS = -I/ucrt64/include/cairo

## For building docs/installer
ISDIR = $(HOME)/scoop/apps/innosetup/current
QPDF = $(HOME)/scoop/apps/qpdf/current
MAKEINFO = texi2any
TEXI2ANY = texi2any

## Fix for MiKTeX removing texi2dvi
TEXI2DVI = TEXINDEX=@texindex@ texify
 